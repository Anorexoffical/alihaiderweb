import{r as l,j as e}from"./index-XqtgtB4L.js";const k="/assets/payment-ihJWkFNo.png",I=()=>{const n=JSON.parse(localStorage.getItem("cart"))||[],i=n.reduce((s,a)=>s+a.price*a.quantity,0),f=n.reduce((s,a)=>s+a.quantity,0),j=i*.3,N=i+j,[y,g]=l.useState([]),[c,C]=l.useState(""),[o,b]=l.useState(""),[d,S]=l.useState(""),[m,w]=l.useState(""),[h,E]=l.useState(""),[x,q]=l.useState(""),[u,P]=l.useState(""),[p,O]=l.useState(""),[t,F]=l.useState({});l.useEffect(()=>{fetch("https://restcountries.com/v3.1/all").then(s=>s.json()).then(s=>{const a=s.map(r=>r.name.common).sort();g(a)}).catch(s=>console.error("Error fetching countries:",s))},[]);const $=s=>{const a=s.target.value;C(a),b(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?"":"Invalid email format")},R=async()=>{const s={};if(c||(s.email="Email is required"),d||(s.firstName="First name is required"),m||(s.lastName="Last name is required"),h||(s.address="Address is required"),x||(s.postalCode="Postal code is required"),u||(s.phoneNO="Phone number is required"),p||(s.selectedCountry="Country selection is required"),F(s),Object.keys(s).length>0)return;const a={firstName:d,lastName:m,email:c,totalAmount:N.toFixed(2),items:n,address:h,postalCode:x,phoneNO:u,selectedCountry:p};try{const v=await(await fetch("https://icellmobile.co.za/api/payfast/initiate-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();v.paymentUrl?window.location.href=v.paymentUrl:alert("Payment initiation failed!")}catch(r){console.error("Error:",r)}};return e.jsx("div",{className:"container my-5",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-7 col-md-12",children:[e.jsx("h2",{children:"Checkout"}),e.jsxs("form",{children:[e.jsx("h4",{children:"Contact Information"}),e.jsx("input",{type:"email",required:!0,className:`form-control mb-2 ${o||t.email?"is-invalid":""}`,placeholder:"Email",value:c,onChange:$}),(o||t.email)&&e.jsx("div",{className:"text-danger",children:o||t.email}),e.jsx("h4",{children:"Delivery Details"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-12",children:[e.jsxs("select",{className:`form-control mb-3 ${t.selectedCountry?"is-invalid":""}`,value:p,onChange:s=>O(s.target.value),children:[e.jsx("option",{children:"Select Country"}),y.map((s,a)=>e.jsx("option",{value:s,children:s},a))]}),t.selectedCountry&&e.jsx("div",{className:"text-danger",children:t.selectedCountry})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("input",{type:"text",className:`form-control mb-3 ${t.firstName?"is-invalid":""}`,placeholder:"First Name",value:d,onChange:s=>S(s.target.value)}),t.firstName&&e.jsx("div",{className:"text-danger",children:t.firstName})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("input",{type:"text",className:`form-control mb-3 ${t.lastName?"is-invalid":""}`,placeholder:"Last Name",value:m,onChange:s=>w(s.target.value)}),t.lastName&&e.jsx("div",{className:"text-danger",children:t.lastName})]})]}),e.jsx("input",{type:"text",className:`form-control mb-3 ${t.address?"is-invalid":""}`,placeholder:"Address",value:h,onChange:s=>E(s.target.value)}),t.address&&e.jsx("div",{className:"text-danger",children:t.address}),e.jsx("input",{type:"text",className:`form-control mb-3 ${t.postalCode?"is-invalid":""}`,placeholder:"Postal Code",value:x,onChange:s=>q(s.target.value)}),t.postalCode&&e.jsx("div",{className:"text-danger",children:t.postalCode}),e.jsx("input",{type:"text",className:`form-control mb-3 ${t.phoneNO?"is-invalid":""}`,placeholder:"Phone Number",value:u,onChange:s=>P(s.target.value)}),t.phoneNO&&e.jsx("div",{className:"text-danger",children:t.phoneNO})]}),e.jsxs("div",{className:"card mt-4 p-3",children:[e.jsx("h4",{children:"Payment"}),e.jsx("p",{children:"All transactions are secure and encrypted."}),e.jsx("div",{className:"bg-white text-center",children:e.jsx("img",{src:k,alt:"Mastercard",className:"img-fluid"})})]})]}),e.jsx("div",{className:"col-lg-5 col-md-12 mt-4 mt-lg-0",children:e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"border-bottom pb-3",children:"Order Summary"}),n.map((s,a)=>e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:s.image,alt:s.title,width:"50",className:"me-3 img-fluid"}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-0",children:s.title}),e.jsxs("small",{children:["Qty: ",s.quantity]})]})]}),e.jsxs("p",{className:"mb-0",children:["R ",s.price*s.quantity]})]},a)),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("p",{children:["Subtotal (",f," items)"]}),e.jsxs("p",{children:["R ",i.toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("p",{children:"Tax (3%)"}),e.jsxs("p",{children:["R ",j.toFixed(2)]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between fw-bold",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{children:["R ",N.toFixed(2)]})]}),e.jsx("button",{className:"callformeeting checkout",onClick:R,children:"Pay Now"})]})})]})})};export{I as default};
